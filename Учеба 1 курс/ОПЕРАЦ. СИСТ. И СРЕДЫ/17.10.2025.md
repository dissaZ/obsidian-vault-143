[[ОСИС]]
# Автоматизация задач в windows. Пакетные файлы .bat & .cmd

Пакетные файлы - это текстовые файлы с расширением .bat & .cmd, содержащие последовательность команд для командного интерпретатора windows. Они позволяют автоматизировать повторяющиеся задачи без ручного ввода команд.

### Преимущества использования
- Экономия времени
- минимизация человеческих ошибок
- возможность сложной логики выполнения
- интеграция с системными утилитами windows.

#### Разница
.cmd - new ==working on only new system, but have more functions than .bat==
.bat - old ==working on all systems


| Ключевое слово        | Описание                                                       |
| --------------------- | -------------------------------------------------------------- |
| Echo on               | включает вывод выполняемых команд                              |
| @echo off             | отключает вывод выполняемых команд, показывая только результат |
| pause                 | Остановка до нажатия любой клавиши                             |
| timeout /t 2          | пауза на 2с                                                    |
| exit /b               | выход из скрипта                                               |
| ds                    | очистка экрана                                                 |
| echo                  | вывод текста на экран                                          |
| echo.                 | вывод пустой строки                                            |
| title заголовок       | установка заголовка окна                                       |
| color 0A              | изменение цвета текста 0-фон А-текст                           |
| rem                   | Комментарий                                                    |
| set                   | Вывод текста на экран                                          |
| set /a                | Арифметическая операция                                        |
| set /p                | ввод от пользователя                                           |
| setlocal              | начало локальной области переменных                            |
| endlocal              | конец локальной области переменных                             |
| :                     | обозначение метки                                              |
| goto                  | переход к метке                                                |
| if - else             | условный оператор                                              |
| %action%              | %..% помогают прочесть значения переменной                     |
| chcp (65001,822,1251) | настройка языка который будет выводиться                       |
|                       |                                                                |
|                       |                                                                |
|                       |                                                                |

## Начало работы
1) Создать текстовый файл
2) Написать команды
3) переименовать расширение с .txt на .cmd
4) запустить переименованный файл


### Цикл For
For - классический перебор элементов
For /L - Цикл с числами ( аналог i=1 to 10)
for /d - работа только с каталогами
for /r - рекурсивный обход папок
for /f - обработка текста и файлов

For `%%переменная IN (набор_элементов) do (
`команда_для_выполнения
`)

```
FOR / • Цикл с числами
FOR /l %% in (старт, шаг, конец) DО команда
Создание 5 папок:
FOR /l %% IN(1,5) DO mkdir Folders%%i
Обратный отсчет:
FOR /L %%i IN (5-1,1) DO echo Осталось: %% сек.
Только четные числа:
FOR /L %%i IN (2,2,10) DO echo Четное: %%i

```

`for/F "параметры" %%i IN (источник) do команда`
- (строка1 строка2 строка3) - прямо в коде
- (filename.txt) - из файла
- (команда) - результат выполнения команды

## Чтение файлов построчно
`for /f "tokens=*" %%i IN (config.txt) do(
`echo строка: %%i)`

## Разбор вывода команды:
`for /f "tokens=2" %%i IN (systeminfo ^ | findstr /B /C:"Имя ОС") do ( echo Версия ОС: %%i`

## Обработка csv файла:
`for /f tokens=1,3 delims=," %%i IN (data.csv) DO ( echo Имя: %%i, Возраст: %%j )`

# Ключевые параметры for /f
**delims** - разделители полей ( пробел, табуляция)

`for /f "delims=;" %%i IN (Иванов;25;инженер") DO echo Фамилия: %%i

**tokens=** - какие поля извлекать
tokens=1 - 1 поле
tokens=1,3 - первое и третье (`%%i и %%j`)
tokens=1-3 - поля с первой по третье (`%%i, %%j, %%k`)
tokens=* - вся строка

skip= - пропустить первые N строк


| Модификатор | Результат                 |
| ----------- | ------------------------- |
| `%%~di`     | Только диск               |
| `%%~pi`     | только путь               |
| `%%~ni`     | только имя без расширения |
| `%%~xi`     | только расширения         |
| `%%~zi`     | размер файла              |
| `%%~fi`     | полный путь               |
